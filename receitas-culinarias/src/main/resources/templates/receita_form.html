<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title th:with="isEdit=${#ctx.containsVariable('id')} ? (${id} != null) : (${#ctx.containsVariable('modo')} ? (${modo} == 'edit') : false)"
        th:text="${isEdit} ? 'Editar Receita' : 'Cadastrar Receita'">
    Receita
  </title>
  <link rel="stylesheet" href="/css/receita_form.css">
</head>
<body th:with="isEdit=${#ctx.containsVariable('id')} ? (${id} != null) : (${#ctx.containsVariable('modo')} ? (${modo} == 'edit') : false)">
  <div class="recipe-container">
    <div class="recipe-card">
      <h1 th:text="${isEdit} ? 'Editar Receita' : 'Cadastrar Receita'">Receita</h1>

      <!-- CSRF -->
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

      <!-- Form -->
      <form th:action="${isEdit} ? @{/receitas/{id}(id=${id})} : @{/receitas}"
            th:object="${receita}" method="post" novalidate>

        <!-- erros globais -->
        <div class="erro" th:if="${#fields.hasGlobalErrors()}"
             th:each="e : ${#fields.globalErrors()}" th:text="${e}"></div>

        <label>Nome</label>
        <input th:field="*{nome}" placeholder="Ex.: Bolo de Cenoura" />
        <div class="erro" th:if="${#fields.hasErrors('nome')}" th:errors="*{nome}"></div>

        <label>Ingredientes</label>
        <textarea th:field="*{ingredientes}" placeholder="Ex.: 3 ovos, 2 xícaras de farinha, ..."></textarea>
        <div class="erro" th:if="${#fields.hasErrors('ingredientes')}" th:errors="*{ingredientes}"></div>

        <label>Modo de Preparo</label>
        <textarea th:field="*{modoPreparo}" placeholder="Passo a passo do preparo..."></textarea>
        <div class="erro" th:if="${#fields.hasErrors('modoPreparo')}" th:errors="*{modoPreparo}"></div>

        <div class="actions">
          <button type="submit" th:text="${isEdit} ? 'Salvar alterações' : 'Cadastrar'">Salvar</button>
          <a th:href="@{/receitas}">Cancelar</a>
        </div>
      </form>
    </div>
  </div>
</body>
</html>
