<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>Usuários</title>
  <style>
    body{font-family:sans-serif;max-width:900px;margin:24px auto}
    table{border-collapse:collapse;width:100%}
    th,td{border:1px solid #ddd;padding:8px}
    th{background:#fafafa;text-align:left}
    .msg{padding:8px;margin-bottom:12px;border:1px solid}
    .ok{background:#e8ffe8;border-color:#b6e3b6}
    .err{background:#ffe8e8;border-color:#e3b6b6}
    .actions form{display:inline}
    a, button { cursor:pointer }
  </style>
</head>
<body>
  <h1>Usuários</h1>
  <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />


  <!-- mensagens vindas de flash attributes -->
  <div class="msg ok" th:if="${successMessage}" th:text="${successMessage}"></div>
  <div class="msg err" th:if="${errorMessage}" th:text="${errorMessage}"></div>

  <p><a th:href="@{/usuarios/new}">+ Novo usuário</a></p>

  <table>
    <thead>
      <tr>
        <th style="width:80px">ID</th>
        <th>Nome</th>
        <th style="width:160px">CPF</th>
        <th>E-mail</th>
        <th style="width:240px">Ações</th>
      </tr>
    </thead>
    <tbody>
      <!-- lista de usuários -->
      <tr th:each="u : ${usuarios}">
        <td th:text="${u.id}">1</td>
        <td th:text="${u.nome}">Nome</td>
        <td th:text="${u.cpf}">00000000000</td>
        <td th:text="${u.email}">email@ex.com</td>
        <td class="actions">
          <a th:href="@{|/usuarios/${u.id}|}">Detalhes</a> |
          <a th:href="@{|/usuarios/${u.id}/edit|}">Editar</a> |
          <form th:action="@{|/usuarios/${u.id}/delete|}" method="post"
                onsubmit="return confirm('Tem certeza que deseja excluir?');">
            <!-- Se usar Spring Security, descomente as 2 linhas abaixo -->
            <!-- <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" /> -->
            <button type="submit">Excluir</button>
          </form>
        </td>
        <td>
          <a th:href="@{|/usuarios/${u.id}/edit|}">Editar</a>
          <form th:if="${u.perfil != 'COZINHEIRO'}"
                th:action="@{|/usuarios/${u.id}/cozinheiro|}"
                method="post" style="display:inline">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <button type="submit">Tornar Cozinheiro</button>
          </form>
        </td>
      </tr>

      <!-- estado vazio -->
      <tr th:if="${#lists.isEmpty(usuarios)}">
        <td colspan="5">Nenhum usuário cadastrado.</td>
      </tr>
    </tbody>
  </table>
</body>
</html>
